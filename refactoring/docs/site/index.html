
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="encoding_ref/">
      
      
      <link rel="icon" href="img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.35">
    
    
      
        <title>Quantum Genome Encoder</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Quantum Genome Encoder" class="md-header__button md-logo" aria-label="Quantum Genome Encoder" data-md-component="logo">
      
  <img src="img/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quantum Genome Encoder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Quantum Genome Encoder" class="md-nav__button md-logo" aria-label="Quantum Genome Encoder" data-md-component="logo">
      
  <img src="img/favicon.png" alt="logo">

    </a>
    Quantum Genome Encoder
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Overview
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      The Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#state-vector-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      State vector encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construction-of-mps" class="md-nav__link">
    <span class="md-ellipsis">
      Construction of MPS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fidelity-and-the-required-bond-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      Fidelity and the required bond dimension
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-mps-to-quantum-circuits" class="md-nav__link">
    <span class="md-ellipsis">
      Converting MPS to Quantum Circuits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="encoding_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mps_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MPS construction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="states_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic states
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      The Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#state-vector-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      State vector encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construction-of-mps" class="md-nav__link">
    <span class="md-ellipsis">
      Construction of MPS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fidelity-and-the-required-bond-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      Fidelity and the required bond dimension
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-mps-to-quantum-circuits" class="md-nav__link">
    <span class="md-ellipsis">
      Converting MPS to Quantum Circuits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="overview">Overview</h1>
<p>This resource describes the functionality of the quantum genome
encoding library that has been developed as part of Phase I of
the Wellcome Leap Quantum Pangenomics project, developed by a
team spanning the University of Melbourne, the University of
Cambridge, Kyiv Academic University, and the Wellcome Trust
Sanger Institute.</p>
<p>The library presents a novel and performant method of encoding
genomic data for use in quantum computing and quantum computing
simulations on high performance computing (HPC) clusters.</p>
<h2 id="the-algorithm">The Algorithm</h2>
<p>In broad strokes, the method obtains a quantum circuit encoding
of genomic data by producing a normalised state vector from the
data. This state vector is then transformed into a tensor of
high rank, which is decomposed into a <strong>Matrix Product State</strong> (MPS)
by repeated applications of the Singular Value Decomposition (SVD).
This matrix product state is then used to construct a quantum
circuit by repeatedly applying unitary gates until the desired
fidelity ot the input state is achieved.</p>
<h3 id="state-vector-encoding">State vector encoding</h3>
<p>To encode the genomic data as a normalised quantum state vector,
we use a binary position and base register to obtain a compact
description.</p>
<p>The base register requires two qubits, and we map the bases according
to the following table:</p>
<table>
<thead>
<tr>
<th>A</th>
<th>T</th>
<th>G</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>00</td>
<td>01</td>
<td>10</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>We then combine this with the binary representation of the index along
the genome read to produce a new index for the state vector - the value
of the state vector component at the new index will be set to <code>1</code> and
all others will be set to <code>0</code>. Finally, the state vector will be
normalised to unit magnitude.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The (very) short genome read <span class="arithmatex">\(AT\)</span> can be encoded in 3 qubits, and
becomes <span class="arithmatex">\(\frac{1}{\sqrt{2}}(1, 0, 0, 0, 0, 1, 0, 0)\)</span>.</p>
</div>
<p>In general, this means that a genome of length <span class="arithmatex">\(L\)</span> requires
<span class="arithmatex">\(N = \lceil \log_2{L} \rceil + 2\)</span> qubits to be encoded in our framework.</p>
<p>The number of qubits required becomes the number of nodes in the MPS.</p>
<p>The encoding is implemented in <code>encoding.encode_genome</code>, there is also a
companion function to decode the state vector into a genome,
<code>encoding.decode_state</code>.</p>
<h3 id="construction-of-mps">Construction of MPS</h3>
<p>We construct the MPS representation of a state vector by first recasting
it as a high rank tensor (i.e. a tensor of rank <span class="arithmatex">\(2^{N-1}\)</span> where <span class="arithmatex">\(N\)</span> is the
number of qubits required). No information is lost in this stage as this
is a simple 'reshape' of the vector. Each rank has physical dimension
<span class="arithmatex">\(d=2\)</span>.</p>
<p>The next stage is to decompose the tensor into the MPS form, with a given
bond dimension <span class="arithmatex">\(D\)</span> (we detail how to calculate this parameter in the next
section). This is done by performing a SVD between each rank (i.e. <span class="arithmatex">\(2^{N-1}-1\)</span>
SVD operations), as illustrated in the figure below
(<a href="https://tensornetwork.org/mps/mpstt_diagram.png">tensornetwork.org</a>):</p>
<p align="center">
  <img alt="MPS decomposition diagram, from tensornetwork.org" src="https://tensornetwork.org/mps/mpstt_diagram.png"/>
</p>

<p>The SVD are performed between each rank in sequence to obtain the MPS encoding.
Importantly, information is lost (in general) in this stage, as we have reduced
the amount of data - this means the fidelity of the representation to the
original state vector is reduced. Strictly, the equality in the figure does not
hold. We can summarise the high-level process in the following flow chart:</p>
<pre class="mermaid"><code>graph LR
  A[Genome read] --&gt; B[State vector];
  B --&gt;|Reshape| C[High rank tensor];
  C --&gt;D{Done all SVD required ?};
  D --&gt;|Yes| E[Finished, return MPS];
  D --&gt;|No| F[Perform SVD between next two ranks];
  F --&gt;D;</code></pre>
<p>This is implemented in <code>encoding.create_mps</code>, and can create a MPS from an
arbitrary normalised state vector.</p>
<h3 id="fidelity-and-the-required-bond-dimension">Fidelity and the required bond dimension</h3>
<p>A method is provided in the code to estimate the required bond dimension,
<code>encoding.analyse_required_bond_dim</code>. For a given state vector, this method
returns an estimate of the minimum bond dimension required to achieve a
specified fidelity to the input state vector.</p>
<p>In general, a larger bond dimension will give a larger fidelity to the original
state since more of the original data would be retained. However, the
computational cost of working with the MPS increases as the bond dimension
increases for precisely the same reason.</p>
<p>This method will analyse the fidelity of the MPS to the original state vector
for a given bond dimension and incrememnt the bond dimension until the fidelity
required is achieved.</p>
<p align="center">
  <img alt="Reconstruction error against bond dimension for a read of lenght 100" src="img/reconstruction_error_l_100.pdf"/>
</p>

<p>Importantly, we do not increment the bond dimension by unity after each check -
we save on computational cost by using a similar method to gradient descent
and estimate the jump in bond dimension required. See the figure above for an
example of the reconstruction error as plotted against the bond dimension
for a read of length 100.</p>
<p>The descent model is tuneable so that the risk of significantly overestimating
the required bond dimension may be mitigated.</p>
<h3 id="converting-mps-to-quantum-circuits">Converting MPS to Quantum Circuits</h3>
<p>The correspondence between quantum circuits and MPS is well-understood and
documented, in short a quantum circuit with no gates is the tensor product of
the input qubits. Applying gates is then equivalent to contracting two of the
qubits together. For a two qubit gate, the input qubits are entangled to a tensor
of rank two which can be decomposed with the SVD. Applying this for all the gates
in a generic quantum circuit gives us a MPS state. This is illustrated in the
figure below (<a href="https://www.nature.com/articles/s41598-023-30258-y">Guala et al., 2023</a>):</p>
<p align="center">
  <img alt="MPS to quantum circuit correspondence" src="img/mps-circuit.png">
</p>

<p>In the library, we use the method <code>encoding.convert_mps_to_circuit</code> to produce a
quantum circuit that is equivalent to a matrix product state. The main input to
the method is the state vector which the quantum circuit should reproduce to a
requested fidelity. The quantum circuits are implemented using the IBM QisKit
API, though we plan to remove QisKit dependence from the library in the future.</p>
<p>The process is iterative, and adds unitary gates to the quantum circuit until the
required acuracy has been achieved. The accuracy is judged at each stage by producing
the inverse of the circuit and comparing to the original state vector.</p>
<p>The key innovation of this method is the method of producing the two-qubit unitary
gates, which uses the MPS formulation of the circuit inverse. The gates are produced
by reorganising the tensor corresponding to each node in the MPS into a matrix, and
concatenating each matrix with its null state. The high-level operation of the
algorithm is shown in the flow chart below:</p>
<pre class="mermaid"><code>graph LR
  A[State vector] --&gt; B[Initialise empty circuit];
  B --&gt;C[Produce MPS];
  C --&gt;D[Produce gates from MPS];
  D --&gt;E[Add gates to circuit];
  E --&gt;F{Circuit inverse == state vector ?};
  F --&gt;|Yes| G[Finished, return circuit];
  F --&gt;|No| H[Create state vector from inverse];
  H --&gt;B;</code></pre>
<p>It is worth focusing on the method of producing gates, this is done by iterating
in reverse through the MPS nodes and applying the procedure specified above. This
means reshaping each node <span class="arithmatex">\(n_i\)</span> in the tensor network first to <span class="arithmatex">\(4\times x_i\)</span> matrices
<span class="arithmatex">\(V_i\)</span> (where <span class="arithmatex">\(x_i\)</span> is computed dynamically for dimensional consistency). The null
space of the matrix <span class="arithmatex">\(V_i\)</span> is also computed, which we name <span class="arithmatex">\(\operatorname{null}(A_i)\)</span>.</p>
<p>These matrices are concatenated to form a unitary gate
<span class="arithmatex">\(U_i=V_i \frown \operatorname{null}(A_i)\)</span>, which entangles qubits <span class="arithmatex">\(N-i-1\)</span> and <span class="arithmatex">\(N-i\)</span> with
<span class="arithmatex">\(N\)</span> the total number of qubits.</p>
<p>This method of iteratively adding unitary gates produces circuits more economical in
depth compared to the pure QisKit implementation (using only basic Clifford gates),
as illustrated by the gate count comparisons below:</p>
<p align="center">
  <img alt="Gate scaling for MPS and QisKit for genome reads of length up to 100" style="max-width: 60%" src="img/phi_gate_scaling.png"/>
</p>

<p>The greater economy in gates is illustrated clearly, the discrete jumps in gate count
indicate an increase in the number of qubits required to encode the genome.</p>
<p>Even without optimisation, the economy of this approach makes clear that MPS can
provide a more favourable encoding than pure QisKit. We relegate the discussion
of the optimisation to future documentation for now.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; <script>document.write(new Date().getFullYear())</script> Genome Research Ltd.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy", "navigation.indexes", "navigation.expand", "search.suggest", "search.highlight"], "search": "assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>